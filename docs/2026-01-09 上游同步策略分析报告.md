# ä¸Šæ¸¸ä»“åº“ Antigravity API åŒæ­¥ç­–ç•¥åˆ†ææŠ¥å‘Š

**ç”Ÿæˆæ—¶é—´**: 2026-01-09  
**åˆ†æç›®æ ‡**: ä¸Šæ¸¸ä»“åº“ `https://github.com/su-kaka/gcli2api` 1æœˆ8æ—¥æ›´æ–°  
**é—®é¢˜èƒŒæ™¯**: æœ¬åœ°ç‰ˆæœ¬å‡ºç° 429/404 é”™è¯¯ï¼Œä¸Šæ¸¸æœ€æ–°ç‰ˆæœ¬å¯ç”¨

---

## ä¸€ã€ä¸Šæ¸¸ä»“åº“å…³é”®æäº¤åˆ†æ

### 1.1 1æœˆ8æ—¥ Antigravity API ç›¸å…³æäº¤æ¸…å•

| æäº¤å“ˆå¸Œ | æ—¶é—´ | æäº¤ä¿¡æ¯ | å½±å“æ–‡ä»¶ |
|---------|------|---------|---------|
| `21b2ae4` | 2026-01-08 04:30 | Update antigravity_api.py | `src/antigravity_api.py` |
| `7355306` | 2026-01-08 04:20 | Update antigravity_api.py | `src/antigravity_api.py` |
| `b019d9b` | 2026-01-08 04:16 | Update antigravity_api.py | `src/antigravity_api.py` |
| `2a88cde` | 2026-01-08 04:08 | Update antigravity_api.py | `src/antigravity_api.py` |

**å…³é”®å‘ç°**: 1æœˆ8æ—¥æœ‰4æ¬¡è¿ç»­çš„ `antigravity_api.py` æ›´æ–°ï¼Œè¯´æ˜ä½œè€…åœ¨ä¿®å¤ Antigravity API å¯¹æ¥é—®é¢˜ã€‚

### 1.2 ä¸Šæ¸¸æœ€æ–°ç‰ˆæœ¬å…³é”®å˜æ›´

#### å˜æ›´1: æ·»åŠ  `requestType: "agent"` å­—æ®µ

**ä½ç½®**: `build_antigravity_request_body()` å‡½æ•°

**ä¸Šæ¸¸ä»£ç **:
```python
request_body = {
    "project": project_id,
    "requestId": generate_request_id(),
    "model": model,
    "userAgent": "antigravity",
    "requestType": "agent",  # â† æ–°å¢å­—æ®µ
    "request": {
        "contents": contents,
        "session_id": session_id,
    }
}
```

**æœ¬åœ°ä»£ç **: âŒ **ç¼ºå¤±æ­¤å­—æ®µ**

**å½±å“**: è¿™å¯èƒ½æ˜¯å¯¼è‡´ 429/404 é”™è¯¯çš„æ ¹æœ¬åŸå› ï¼Antigravity API å¯èƒ½è¦æ±‚å¿…é¡»æä¾› `requestType: "agent"` å­—æ®µã€‚

#### å˜æ›´2: æ·»åŠ  `custom_prompt` åˆ° `systemInstruction`

**ä½ç½®**: `build_antigravity_request_body()` å‡½æ•°

**ä¸Šæ¸¸ä»£ç **:
```python
# æ·»åŠ ç³»ç»ŸæŒ‡ä»¤
custom_prompt = "<identity>\\nYou are Antigravity, a powerful agentic AI coding assistant..."
    
if system_instruction:
    # å­˜åœ¨ systemInstructionï¼Œå°†å ä½ç¬¦æ”¾åœ¨ä½ç½®0ï¼ŒåŸæœ‰å†…å®¹é™æ ¼åˆ°ä½ç½®1åŠä»¥ä¸‹
    if isinstance(system_instruction, dict):
        parts = system_instruction.get("parts", [])
        if parts:
            # å°†å ä½ç¬¦æ’å…¥åˆ°ä½ç½®0ï¼ŒåŸæœ‰å†…å®¹åç§»
            system_instruction["parts"] = [{"text": custom_prompt}] + parts
        else:
            system_instruction["parts"] = [{"text": custom_prompt}]
    request_body["request"]["systemInstruction"] = system_instruction
else:
    # ä¸å­˜åœ¨ systemInstructionï¼Œåˆ›å»ºæ–°çš„
    request_body["request"]["systemInstruction"] = {
        "parts": [{"text": custom_prompt}]
    }
```

**æœ¬åœ°ä»£ç **: âŒ **ç¼ºå¤±æ­¤é€»è¾‘**ï¼Œæœ¬åœ°åªæ˜¯ç®€å•ä¼ é€’ `system_instruction`

**å½±å“**: Antigravity API å¯èƒ½è¦æ±‚å¿…é¡»åŒ…å«ç‰¹å®šçš„ `custom_prompt` ä½œä¸ºç³»ç»ŸæŒ‡ä»¤çš„ä¸€éƒ¨åˆ†ã€‚

#### å˜æ›´3: ä½¿ç”¨ `mode="antigravity"` å‚æ•°

**ä½ç½®**: `send_antigravity_request_stream()` å’Œ `send_antigravity_request_no_stream()` å‡½æ•°

**ä¸Šæ¸¸ä»£ç **:
```python
cred_result = await credential_manager.get_valid_credential(
    mode="antigravity", model_key=model_name
)
```

**æœ¬åœ°ä»£ç **: âœ… **å·²ä½¿ç”¨ `is_antigravity=True`**ï¼Œä½†éœ€è¦æ£€æŸ¥ `CredentialManager` æ˜¯å¦æ”¯æŒ `mode` å‚æ•°

**å½±å“**: å¦‚æœ `CredentialManager.get_valid_credential()` ä¸æ”¯æŒ `mode` å‚æ•°ï¼Œéœ€è¦æ·»åŠ å…¼å®¹å±‚ã€‚

---

## äºŒã€æœ¬åœ°è‡ªå®šä¹‰åŠŸèƒ½æ¸…å•

### 2.1 å¿…é¡»ä¿æŠ¤çš„è‡ªå®šä¹‰åŠŸèƒ½

#### åŠŸèƒ½1: `NonRetryableError` å¼‚å¸¸ç±»
- **ä½ç½®**: `src/antigravity_api.py:24-26`
- **ç”¨é€”**: åŒºåˆ†å¯é‡è¯•å’Œä¸å¯é‡è¯•çš„é”™è¯¯
- **ä¿æŠ¤ç­–ç•¥**: âœ… ä¿ç•™ï¼Œä¸å½±å“ä¸Šæ¸¸åŒæ­¥

#### åŠŸèƒ½2: `contents` éªŒè¯é€»è¾‘
- **ä½ç½®**: `src/antigravity_api.py:97-107`
- **ç”¨é€”**: é˜²å¾¡æ€§æ£€æŸ¥ï¼Œç¡®ä¿ `contents` ä¸ä¸ºç©º
- **ä¿æŠ¤ç­–ç•¥**: âœ… ä¿ç•™ï¼Œè¿™æ˜¯æœ¬åœ°å¢å¼ºåŠŸèƒ½

#### åŠŸèƒ½3: è·¨æ± é™çº§åŠŸèƒ½ (`enable_cross_pool_fallback`)
- **ä½ç½®**: `src/antigravity_api.py:223-237`
- **ç”¨é€”**: å½“æŸä¸ªæ¨¡å‹çš„å‡­è¯ä¸å¯ç”¨æ—¶ï¼Œè‡ªåŠ¨é™çº§åˆ°å…¶ä»–æ¨¡å‹
- **ä¿æŠ¤ç­–ç•¥**: âœ… **å¿…é¡»ä¿ç•™**ï¼Œè¿™æ˜¯é‡è¦çš„è‡ªå®šä¹‰åŠŸèƒ½

#### åŠŸèƒ½4: æ¨¡å‹çº§å†·å´ (`model_key` å‚æ•°)
- **ä½ç½®**: `src/antigravity_api.py:219-220`
- **ç”¨é€”**: æ”¯æŒæŒ‰æ¨¡å‹è¿›è¡Œå†·å´ç®¡ç†
- **ä¿æŠ¤ç­–ç•¥**: âœ… ä¿ç•™ï¼Œä¸Šæ¸¸ä¹Ÿä½¿ç”¨äº† `model_key`

#### åŠŸèƒ½5: Signature Cache åŠŸèƒ½
- **ä½ç½®**: `src/signature_cache.py`, `src/patch_antigravity_router.py`
- **ç”¨é€”**: ç¼“å­˜å’Œæ¢å¤ thinking çš„ signature
- **ä¿æŠ¤ç­–ç•¥**: âœ… ä¿ç•™ï¼Œè¿™æ˜¯æœ¬åœ°å¢å¼ºåŠŸèƒ½

#### åŠŸèƒ½6: Sequential Thinking åŠŸèƒ½
- **ä½ç½®**: `src/patch_sequential_thinking.py`
- **ç”¨é€”**: é¼“åŠ±æ¨¡å‹ä½¿ç”¨ Sequential Thinking å·¥å…·
- **ä¿æŠ¤ç­–ç•¥**: âœ… ä¿ç•™ï¼Œè¿™æ˜¯æœ¬åœ°å¢å¼ºåŠŸèƒ½

#### åŠŸèƒ½7: Unified Gateway Router
- **ä½ç½®**: `src/unified_gateway_router.py`
- **ç”¨é€”**: ç»Ÿä¸€ç½‘å…³è·¯ç”±ï¼Œæ”¯æŒå¤šåç«¯
- **ä¿æŠ¤ç­–ç•¥**: âœ… ä¿ç•™ï¼Œè¿™æ˜¯æ ¸å¿ƒè‡ªå®šä¹‰åŠŸèƒ½

#### åŠŸèƒ½8: Fallback Manager
- **ä½ç½®**: `src/fallback_manager.py`
- **ç”¨é€”**: è·¨æ± é™çº§å’Œé”™è¯¯å¤„ç†
- **ä¿æŠ¤ç­–ç•¥**: âœ… ä¿ç•™ï¼Œè¿™æ˜¯æ ¸å¿ƒè‡ªå®šä¹‰åŠŸèƒ½

### 2.2 éœ€è¦å…¼å®¹çš„å‚æ•°å·®å¼‚

#### å‚æ•°å·®å¼‚: `is_antigravity` vs `mode`

**ä¸Šæ¸¸ä½¿ç”¨**:
```python
cred_result = await credential_manager.get_valid_credential(
    mode="antigravity", model_key=model_name
)
```

**æœ¬åœ°ä½¿ç”¨**:
```python
cred_result = await credential_manager.get_valid_credential(
    is_antigravity=True, model_key=model_name
)
```

**å…¼å®¹ç­–ç•¥**: 
- æ£€æŸ¥ `CredentialManager.get_valid_credential()` æ˜¯å¦æ”¯æŒ `mode` å‚æ•°
- å¦‚æœä¸æ”¯æŒï¼Œéœ€è¦æ·»åŠ å…¼å®¹å±‚ï¼ŒåŒæ—¶æ”¯æŒ `mode` å’Œ `is_antigravity` å‚æ•°

---

## ä¸‰ã€åŒæ­¥ç­–ç•¥

### 3.1 ç›´æ¥åˆå¹¶çš„æ›´æ–°

#### âœ… æ›´æ–°1: æ·»åŠ  `requestType: "agent"` å­—æ®µ
- **æ“ä½œ**: ç›´æ¥æ·»åŠ åˆ° `build_antigravity_request_body()` å‡½æ•°
- **ä½ç½®**: `src/antigravity_api.py:109-118`
- **é£é™©**: ä½ï¼Œè¿™æ˜¯æ–°å¢å­—æ®µï¼Œä¸å½±å“ç°æœ‰é€»è¾‘

#### âœ… æ›´æ–°2: æ·»åŠ  `custom_prompt` é€»è¾‘
- **æ“ä½œ**: æ·»åŠ åˆ° `build_antigravity_request_body()` å‡½æ•°
- **ä½ç½®**: `src/antigravity_api.py:120-135` ä¹‹å
- **é£é™©**: ä½ï¼Œè¿™æ˜¯æ–°å¢é€»è¾‘ï¼Œä½†éœ€è¦ç¡®ä¿ä¸ç°æœ‰çš„ `system_instruction` å¤„ç†å…¼å®¹

### 3.2 éœ€è¦ä¿®æ”¹ååˆå¹¶çš„æ›´æ–°

#### âš ï¸ æ›´æ–°3: `mode="antigravity"` å‚æ•°
- **æ“ä½œ**: 
  1. æ£€æŸ¥ `CredentialManager.get_valid_credential()` æ˜¯å¦æ”¯æŒ `mode` å‚æ•°
  2. å¦‚æœä¸æ”¯æŒï¼Œæ·»åŠ å…¼å®¹å±‚ï¼š
     ```python
     # å…¼å®¹ mode å’Œ is_antigravity å‚æ•°
     if 'mode' in kwargs:
         is_antigravity = (kwargs['mode'] == 'antigravity')
     ```
  3. æˆ–è€…ä¿®æ”¹ `CredentialManager` æ”¯æŒ `mode` å‚æ•°ï¼ˆæ¨èï¼‰
- **é£é™©**: ä¸­ï¼Œéœ€è¦ç¡®ä¿æ‰€æœ‰è°ƒç”¨ç‚¹éƒ½æ›´æ–°

### 3.3 ä¸è‡ªå®šä¹‰åŠŸèƒ½å†²çªçš„æ›´æ–°

#### âŒ æ— å†²çª
æ‰€æœ‰ä¸Šæ¸¸æ›´æ–°éƒ½å¯ä»¥ä¸æœ¬åœ°è‡ªå®šä¹‰åŠŸèƒ½å…¼å®¹ï¼Œåªéœ€è¦ï¼š
1. ä¿ç•™æœ¬åœ°çš„ `contents` éªŒè¯é€»è¾‘
2. ä¿ç•™æœ¬åœ°çš„è·¨æ± é™çº§åŠŸèƒ½
3. ä¿ç•™æœ¬åœ°çš„å…¶ä»–è‡ªå®šä¹‰åŠŸèƒ½

---

## å››ã€è¯¦ç»†åŒæ­¥æ“ä½œæ­¥éª¤

### æ­¥éª¤1: å¤‡ä»½å½“å‰ä»£ç 
```bash
cd F:\antigravity2api\gcli2api
git add .
git commit -m "å¤‡ä»½ï¼šåŒæ­¥ä¸Šæ¸¸æ›´æ–°å‰çš„çŠ¶æ€"
git tag backup-before-upstream-sync-$(date +%Y%m%d)
```

### æ­¥éª¤2: æ£€æŸ¥ CredentialManager å‚æ•°æ”¯æŒ
- æ£€æŸ¥ `src/credential_manager.py` ä¸­ `get_valid_credential()` æ–¹æ³•çš„ç­¾å
- å¦‚æœåªæ”¯æŒ `is_antigravity`ï¼Œéœ€è¦æ·»åŠ  `mode` å‚æ•°æ”¯æŒ

### æ­¥éª¤3: æ›´æ–° `build_antigravity_request_body()` å‡½æ•°
1. æ·»åŠ  `requestType: "agent"` å­—æ®µ
2. æ·»åŠ  `custom_prompt` é€»è¾‘
3. ä¿ç•™æœ¬åœ°çš„ `contents` éªŒè¯é€»è¾‘

### æ­¥éª¤4: æ›´æ–° `send_antigravity_request_stream()` å‡½æ•°
1. å°† `is_antigravity=True` æ”¹ä¸º `mode="antigravity"`ï¼ˆå¦‚æœ `CredentialManager` æ”¯æŒï¼‰
2. æˆ–è€…æ·»åŠ å…¼å®¹å±‚
3. ä¿ç•™æœ¬åœ°çš„è·¨æ± é™çº§åŠŸèƒ½

### æ­¥éª¤5: æ›´æ–° `send_antigravity_request_no_stream()` å‡½æ•°
1. å°† `is_antigravity=True` æ”¹ä¸º `mode="antigravity"`ï¼ˆå¦‚æœ `CredentialManager` æ”¯æŒï¼‰
2. æˆ–è€…æ·»åŠ å…¼å®¹å±‚

### æ­¥éª¤6: æ›´æ–°å…¶ä»–è°ƒç”¨ç‚¹
- æ£€æŸ¥æ‰€æœ‰è°ƒç”¨ `get_valid_credential(is_antigravity=True)` çš„åœ°æ–¹
- å¦‚æœ `CredentialManager` æ”¯æŒ `mode` å‚æ•°ï¼Œç»Ÿä¸€æ”¹ä¸º `mode="antigravity"`
- å¦‚æœä¸æ”¯æŒï¼Œä¿æŒ `is_antigravity=True`

### æ­¥éª¤7: æµ‹è¯•éªŒè¯
1. æµ‹è¯• Claude æ¨¡å‹è¯·æ±‚ï¼ˆä¹‹å‰è¿”å› 429ï¼‰
2. æµ‹è¯• Gemini æ¨¡å‹è¯·æ±‚ï¼ˆä¹‹å‰è¿”å› 404ï¼‰
3. éªŒè¯è·¨æ± é™çº§åŠŸèƒ½ä»ç„¶å·¥ä½œ
4. éªŒè¯å…¶ä»–è‡ªå®šä¹‰åŠŸèƒ½ä»ç„¶å·¥ä½œ

---

## äº”ã€é£é™©è¯„ä¼°ä¸æ³¨æ„äº‹é¡¹

### 5.1 é«˜é£é™©ç‚¹

1. **`CredentialManager` å‚æ•°å…¼å®¹æ€§**
   - **é£é™©**: å¦‚æœ `CredentialManager` ä¸æ”¯æŒ `mode` å‚æ•°ï¼Œéœ€è¦ä¿®æ”¹å…¶å®ç°
   - **ç¼“è§£**: å…ˆæ£€æŸ¥ï¼Œå¦‚æœä¸æ”¯æŒï¼Œæ·»åŠ å…¼å®¹å±‚æˆ–ä¿®æ”¹ `CredentialManager`

2. **`custom_prompt` ä¸ç°æœ‰ `system_instruction` çš„å†²çª**
   - **é£é™©**: å¦‚æœç°æœ‰ä»£ç å·²ç»è®¾ç½®äº† `system_instruction`ï¼Œ`custom_prompt` çš„æ’å…¥å¯èƒ½æ”¹å˜è¡Œä¸º
   - **ç¼“è§£**: ä»”ç»†æµ‹è¯•ï¼Œç¡®ä¿ `custom_prompt` çš„æ’å…¥é€»è¾‘æ­£ç¡®

### 5.2 ä¸­é£é™©ç‚¹

1. **`requestType: "agent"` å­—æ®µçš„å½±å“**
   - **é£é™©**: æœªçŸ¥ï¼Œä½†å¯èƒ½æ˜¯ä¿®å¤ 429/404 é”™è¯¯çš„å…³é”®
   - **ç¼“è§£**: å…ˆæ·»åŠ ï¼Œå¦‚æœå‡ºç°é—®é¢˜å†å›æ»š

2. **å…¶ä»–è°ƒç”¨ç‚¹çš„æ›´æ–°**
   - **é£é™©**: é—æ¼æŸäº›è°ƒç”¨ç‚¹ï¼Œå¯¼è‡´å‚æ•°ä¸åŒ¹é…
   - **ç¼“è§£**: ä½¿ç”¨ `grep` å…¨é¢æœç´¢æ‰€æœ‰è°ƒç”¨ç‚¹

### 5.3 ä½é£é™©ç‚¹

1. **ä¿ç•™æœ¬åœ°è‡ªå®šä¹‰åŠŸèƒ½**
   - **é£é™©**: ä½ï¼Œè¿™äº›åŠŸèƒ½ä¸ä¸Šæ¸¸æ›´æ–°ä¸å†²çª
   - **ç¼“è§£**: ä»”ç»†æ£€æŸ¥æ¯ä¸ªè‡ªå®šä¹‰åŠŸèƒ½ï¼Œç¡®ä¿ä¸è¢«è¦†ç›–

---

## å…­ã€å»ºè®®çš„åˆå¹¶é¡ºåº

### é˜¶æ®µ1: å‡†å¤‡é˜¶æ®µï¼ˆä½é£é™©ï¼‰
1. âœ… å¤‡ä»½å½“å‰ä»£ç 
2. âœ… æ£€æŸ¥ `CredentialManager` å‚æ•°æ”¯æŒ
3. âœ… å…¨é¢æœç´¢æ‰€æœ‰ `is_antigravity` ä½¿ç”¨ç‚¹

### é˜¶æ®µ2: æ ¸å¿ƒæ›´æ–°ï¼ˆä¸­é£é™©ï¼‰
1. âœ… æ·»åŠ  `requestType: "agent"` å­—æ®µ
2. âœ… æ·»åŠ  `custom_prompt` é€»è¾‘
3. âœ… æ›´æ–° `send_antigravity_request_stream()` å’Œ `send_antigravity_request_no_stream()`

### é˜¶æ®µ3: å…¼å®¹æ€§æ›´æ–°ï¼ˆä¸­é£é™©ï¼‰
1. âœ… æ›´æ–° `CredentialManager` æ”¯æŒ `mode` å‚æ•°ï¼ˆå¦‚æœéœ€è¦ï¼‰
2. âœ… æ›´æ–°æ‰€æœ‰è°ƒç”¨ç‚¹ï¼ˆå¦‚æœä½¿ç”¨ `mode` å‚æ•°ï¼‰

### é˜¶æ®µ4: éªŒè¯é˜¶æ®µï¼ˆä½é£é™©ï¼‰
1. âœ… æµ‹è¯• Claude æ¨¡å‹
2. âœ… æµ‹è¯• Gemini æ¨¡å‹
3. âœ… éªŒè¯è‡ªå®šä¹‰åŠŸèƒ½

---

## ä¸ƒã€å…³é”®ä»£ç å¯¹æ¯”

### 7.1 `build_antigravity_request_body()` å‡½æ•°å¯¹æ¯”

**ä¸Šæ¸¸ç‰ˆæœ¬**:
```python
request_body = {
    "project": project_id,
    "requestId": generate_request_id(),
    "model": model,
    "userAgent": "antigravity",
    "requestType": "agent",  # â† å…³é”®å·®å¼‚1
    "request": {
        "contents": contents,
        "session_id": session_id,
    }
}

# æ·»åŠ ç³»ç»ŸæŒ‡ä»¤
custom_prompt = "<identity>\\nYou are Antigravity..."  # â† å…³é”®å·®å¼‚2
if system_instruction:
    # å°† custom_prompt æ’å…¥åˆ° parts[0]
    ...
else:
    request_body["request"]["systemInstruction"] = {
        "parts": [{"text": custom_prompt}]
    }
```

**æœ¬åœ°ç‰ˆæœ¬**:
```python
request_body = {
    "project": project_id,
    "requestId": generate_request_id(),
    "model": model,
    "userAgent": "antigravity",
    # âŒ ç¼ºå¤± requestType: "agent"
    "request": {
        "contents": contents,
        "session_id": session_id,
    }
}

# âœ… æœ¬åœ°æœ‰ contents éªŒè¯é€»è¾‘ï¼ˆéœ€è¦ä¿ç•™ï¼‰
if not contents:
    raise ValueError("contents cannot be empty...")

# æ·»åŠ ç³»ç»ŸæŒ‡ä»¤
if system_instruction:
    request_body["request"]["systemInstruction"] = system_instruction
    # âŒ ç¼ºå¤± custom_prompt é€»è¾‘
```

### 7.2 `send_antigravity_request_stream()` å‡½æ•°å¯¹æ¯”

**ä¸Šæ¸¸ç‰ˆæœ¬**:
```python
cred_result = await credential_manager.get_valid_credential(
    mode="antigravity", model_key=model_name  # â† ä½¿ç”¨ mode å‚æ•°
)
```

**æœ¬åœ°ç‰ˆæœ¬**:
```python
cred_result = await credential_manager.get_valid_credential(
    is_antigravity=True, model_key=model_name  # â† ä½¿ç”¨ is_antigravity å‚æ•°
)

# âœ… æœ¬åœ°æœ‰è·¨æ± é™çº§é€»è¾‘ï¼ˆéœ€è¦ä¿ç•™ï¼‰
if not cred_result and enable_cross_pool_fallback:
    fallback_model = get_cross_pool_fallback(model_name)
    ...
```

---

## å…«ã€æ€»ç»“

### 8.1 å…³é”®å‘ç°

1. **`requestType: "agent"` å­—æ®µç¼ºå¤±** - è¿™å¾ˆå¯èƒ½æ˜¯å¯¼è‡´ 429/404 é”™è¯¯çš„æ ¹æœ¬åŸå› 
2. **`custom_prompt` ç¼ºå¤±** - Antigravity API å¯èƒ½è¦æ±‚å¿…é¡»åŒ…å«ç‰¹å®šçš„ç³»ç»Ÿæç¤ºè¯
3. **å‚æ•°å‘½åå·®å¼‚** - ä¸Šæ¸¸ä½¿ç”¨ `mode="antigravity"`ï¼Œæœ¬åœ°ä½¿ç”¨ `is_antigravity=True`

### 8.2 åŒæ­¥ä¼˜å…ˆçº§

1. **ğŸ”´ é«˜ä¼˜å…ˆçº§**: æ·»åŠ  `requestType: "agent"` å­—æ®µ
2. **ğŸ”´ é«˜ä¼˜å…ˆçº§**: æ·»åŠ  `custom_prompt` é€»è¾‘
3. **ğŸŸ¡ ä¸­ä¼˜å…ˆçº§**: ç»Ÿä¸€å‚æ•°å‘½åï¼ˆ`mode` vs `is_antigravity`ï¼‰
4. **ğŸŸ¢ ä½ä¼˜å…ˆçº§**: å…¶ä»–ä¼˜åŒ–å’Œæ¸…ç†

### 8.3 é¢„æœŸæ•ˆæœ

åŒæ­¥å®Œæˆåï¼Œåº”è¯¥èƒ½å¤Ÿï¼š
- âœ… ä¿®å¤ Claude æ¨¡å‹çš„ 429 é”™è¯¯
- âœ… ä¿®å¤ Gemini æ¨¡å‹çš„ 404 é”™è¯¯
- âœ… ä¿ç•™æ‰€æœ‰æœ¬åœ°è‡ªå®šä¹‰åŠŸèƒ½
- âœ… ä¿æŒä»£ç çš„ç¨³å®šæ€§å’Œå¯ç»´æŠ¤æ€§

---

**æŠ¥å‘Šç”Ÿæˆæ—¶é—´**: 2026-01-09  
**ä¸‹ä¸€æ­¥**: ç­‰å¾…ç”¨æˆ·ç¡®è®¤åå¼€å§‹æ‰§è¡ŒåŒæ­¥æ“ä½œ




